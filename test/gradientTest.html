<head>
    <script src='https://code.jquery.com/jquery-3.2.1.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.4.8/fabric.min.js"></script>

    <!-- color4: -30 116 78 173 0 147 141 117 255
    color: -20 150 145 83 210 212 180
    color: -10 204 207 180 65 91 158
    color: 10 67 97 162 106 208 228
    color: 18 111 214 232 53 213 91
    color: 22 17 213 24 9 94 9
    color: 35 29 104 9 234 210 4 
    color: 40 255 226 0 255 128 0
    color: 50 255 0 0 113 0 0
    color: 60 255 255 255 255 146 255
    color: 65 255 117 255 225 11 227
    color: 70 178 0 255 99 0 214
    color: 75 5 236 240 1 32 32
    color: 85 1 32 32
    color: 95 1 32 32 -->

    <!-- <style>
        #grad {
            background: linear-gradient(
                to right,
                red 20%,
                orange 20% 40%,
                yellow 40% 60%,
                green 60% 80%,
                blue 80%
            );
        }
    </style> -->
</head>

<canvas id='grad'></canvas>
<br><br>
<svg id="svg" xmlns='http://www.w3.org/2000/svg' style="display: none">
    <defs>
        <linearGradient id='g1'>
            <stop stop-color='#744ead' />
            <stop offset='.08' stop-color='#938d75' />
            <stop offset='.08' stop-color='#969153' />
            <stop offset='.16' stop-color='#d2d4b4' />
            <stop offset='.16' stop-color='#cccfb4' />
            <stop offset='.32' stop-color='#415b9e' />
            <stop offset='.32' stop-color='#4361a2' />
            <stop offset='.384' stop-color='#6ad0e1' />
            <stop offset='.384' stop-color='#6fd6e8' />
            <stop offset='.416' stop-color='#35d55b' />
            <stop offset='.416' stop-color='#11d518' />
            <stop offset='.52' stop-color='#095e09' />
            <stop offset='.52' stop-color='#1d6809' />
            <stop offset='.56' stop-color='#ead204' />
            <stop offset='.56' stop-color='#ffe200' />
            <stop offset='.64' stop-color='#ff8000' />
            <stop offset='.64' stop-color='#f00' />
            <stop offset='.72' stop-color='#710000' />
            <stop offset='.72' stop-color='#fff' />
            <stop offset='.76' stop-color='#ff92ff' />
            <stop offset='.76' stop-color='#ff75ff' />
            <stop offset='.8' stop-color='#e10be3' />
            <stop offset='.8' stop-color='#b200ff' />
            <stop offset='.84' stop-color='#6300d6' />
            <stop offset='.84' stop-color='#05ecf0' />
            <stop offset='.92' stop-color='#012020' />
            <stop offset='.92' stop-color='#012020' />
            <stop offset='1' stop-color='#012020' />
        </linearGradient>
    </defs>
    <rect width='100%' height='100%' fill='url(#g1)' />
</svg>

<!--
    AWPIS_filtered

    product: BR
    units: dBZ
    step: 5

    color: 0 0 0 0
    color: 10 67 97 162 106 208 228
    color: 18 111 214 232 53 213 91
    color: 22 17 213 24 9 94 9
    color: 35 29 104 9 234 210 4 
    color: 40 255 226 0 255 128 0
    color: 50 255 0 0 113 0 0
    color: 60 255 255 255 255 146 255
    color: 65 255 117 255 225 11 227
    color: 70 178 0 255 99 0 214
    color: 75 5 236 240 1 32 32
    color: 85 1 32 32
    color: 95 1 32 32

    'rgb(0, 0, 0)',
    'rgb(67, 97, 162)',
    'rgb(111, 214, 232)',
    'rgb(17, 213, 24)',
    'rgb(29, 104, 9)',
    'rgb(255, 226, 0)',
    'rgb(255, 0, 0)',
    'rgb(255, 255, 255)',
    'rgb(255, 117, 255)',
    'rgb(178, 0, 255)',
    'rgb(5, 236, 240)',
    'rgb(1, 32, 32)',
    'rgb(1, 32, 32)',

    'rgb(0, 0, 0)',
    'rgb(106, 208, 228)',
    'rgb(53, 213, 91)',
    'rgb(9, 94, 9)',
    'rgb(234, 210, 4)',
    'rgb(255, 128, 0)',
    'rgb(113, 0, 0)',
    'rgb(255, 146, 255)',
    'rgb(225, 11, 227)',
    'rgb(99, 0, 214)',
    'rgb(1, 32, 32)',
    'rgb(1, 32, 32)',
    'rgb(1, 32, 32)',
-->

<script src="build.js"></script>

<!-- <script>
    var colors = [
        'rgb(116, 78, 173)',
        'rgb(147, 141, 117)',
        'rgb(150, 145, 83)',
        'rgb(210, 212, 180)',
        'rgb(204, 207, 180)',
        'rgb(65, 91, 158)',
        'rgb(67, 97, 162)',
        'rgb(106, 208, 225)',
        'rgb(111, 214, 232)',
        'rgb(53, 213, 91)',
        'rgb(17, 213, 24)',
        'rgb(9, 94, 9)',
        'rgb(29, 104, 9)',
        'rgb(234, 210, 4)',
        'rgb(255, 226, 0)',
        'rgb(255, 128, 0)',
        'rgb(255, 0, 0)',
        'rgb(113, 0, 0)',
        'rgb(255, 255, 255)',
        'rgb(255, 146, 255)',
        'rgb(255, 117, 255)',
        'rgb(225, 11, 227)',
        'rgb(178, 0, 255)',
        'rgb(99, 0, 214)',
        'rgb(5, 236, 240)',
        'rgb(1, 32, 32)',
        'rgb(1, 32, 32)',
        'rgb(1, 32, 32)'
    ]
    var values = [
        -30, -20,
        -20, -10,
        -10, 10,
        10, 18,
        18, 22,
        22, 35,
        35, 40,
        40, 50,
        50, 60,
        60, 65,
        65, 70,
        70, 75,
        75, 85,
        85,
        95
    ]

    var svg = $('#svg');
    var canvasElem = document.getElementById('grad');

    canvasElem.width = (window.innerWidth - 50);
    canvasElem.height = 100;

    svg.width(window.innerWidth - 50)
    svg.height(100)

    canvas = new fabric.StaticCanvas('grad');

    var rect = new fabric.Rect({
        left: 0,
        top: 0,
        width: canvasElem.width,
        height: canvasElem.height
    });

    var cmax = values[values.length - 1];
    var cmin = values[0];
    var clen = colors.length;

    var obj = {};
    for (var i = 0; i < clen; i++) {
        val = (values[i] - cmin) / (cmax - cmin);
        if (obj.hasOwnProperty(val)) {
            obj[val - 0.0001] = obj[val];
            delete obj[val];
        }
        obj[val] = colors[i];
    }
    var keys = Object.keys(obj);
    keys.sort(function(a, b) { return a - b });
    var g = '';
    for (var i in keys) { g += `${keys[i]}: '${obj[keys[i]]}',\n` }
    //console.log(g)

    rect.setGradient('fill', {
        x1: -rect.width / 2,
        y1: 0,
        x2: rect.width / 2,
        y2: 0,
        colorStops: {
            0: 'red',
            0.5: 'green',
            1: 'blue'
        }
    });

    canvas.add(rect);
    canvas.renderAll();

    // {
    //     0: 'rgb(116, 78, 173)',
    //     0.0799: 'rgb(147, 141, 117)',
    //     0.08: 'rgb(150, 145, 83)',
    //     0.1599: 'rgb(210, 212, 180)',
    //     0.16: 'rgb(204, 207, 180)',
    //     0.3199: 'rgb(65, 91, 158)',
    //     0.32: 'rgb(67, 97, 162)',
    //     0.3839: 'rgb(106, 208, 225)',
    //     0.384: 'rgb(111, 214, 232)',
    //     0.4159: 'rgb(53, 213, 91)',
    //     0.416: 'rgb(17, 213, 24)',
    //     0.5199: 'rgb(9, 94, 9)',
    //     0.52: 'rgb(29, 104, 9)',
    //     0.5599: 'rgb(234, 210, 4)',
    //     0.56: 'rgb(255, 226, 0)',
    //     0.6399: 'rgb(255, 128, 0)',
    //     0.64: 'rgb(255, 0, 0)',
    //     0.7199: 'rgb(113, 0, 0)',
    //     0.72: 'rgb(255, 255, 255)',
    //     0.7599: 'rgb(255, 146, 255)',
    //     0.76: 'rgb(255, 117, 255)',
    //     0.7999: 'rgb(225, 11, 227)',
    //     0.8: 'rgb(178, 0, 255)',
    //     0.8399: 'rgb(99, 0, 214)',
    //     0.84: 'rgb(5, 236, 240)',
    //     0.9199: 'rgb(1, 32, 32)',
    //     0.92: 'rgb(1, 32, 32)',
    //     1: 'rgb(1, 32, 32)',
    // }

    //var ctx = canvasElem.getContext('2d');
    //ctx.clearRect(0, 0, canvasElem.width, canvasElem.height);
    //var grdt = ctx.createLinearGradient(0, 0, canvasElem.width, 0);
    ////values.length = colors.length = 19;
    //var cmax = values[values.length - 1];
    //var cmin = values[0];
    //var clen = colors.length;
//
    ////var gradColors = '';
    //var prevColor;
    //var val;
    //for (var i = 0; i < 17; i++) {
    //    val = (values[i] - cmin) / (cmax - cmin);
    //    grdt.addColorStop(val, colors[i]);
//
    //    //var curPercent = (((values[i] - cmin) / (cmax - cmin)) * 100);
    //    //gradColors += `${colors[i]} ${curPercent}%`;
    //    //if (!(i == clen - 1)) { gradColors += ',\n' }
    //}
    //grdt.addColorStop(val, 'rgb(255, 255, 255)');
    //grdt.addColorStop(1, 'rgb(255, 255, 255)');
//
    //ctx.fillStyle = grdt;
    //ctx.fillRect(0, 0, canvasElem.width, canvasElem.height);

    //$('<style>')
    //    .prop('type', 'text/css')
    //    .html(`
    //    #grad {
    //        background: linear-gradient(
    //            to right,
    //            ${gradColors}
    //        );
    //    }`)
    //    .appendTo('head');
//
    //function imgFromSVGnode(node){
    //    var html = node.outerHTML;
    //    var dataURL = 'data:image/svg+xml,' + window.encodeURIComponent(html);
    //    var img = new Image();
    //    img.src = dataURL;
    //    return img;
    //}
    //const c = document.createElement("canvas");
    //const ct = c.getContext("2d");
    //c.width = canvasElem.width;
    //c.height = canvasElem.height;
//
    //var img = imgFromSVGnode(document.getElementById('svg'))
    //img.onload = () => {
    //    ct.drawImage(img, 0, 0);
    //    document.body.appendChild(c)
    //    // imageData = ct.getImageData(0, 0, 300, 1);
    //    // console.log(imageData);
    //}
</script> -->